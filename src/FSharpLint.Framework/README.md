#FSharpLint.Framework

The framework has two main jobs: walkings the abstract syntax tree, and loading configuration.

##Abstract Syntax Tree

[Ast.fs](https://github.com/duckmatt/FSharpLint/blob/master/src/FSharpLint.Framework/Ast.fs) provides an interface for creating and walking the tree. The approach is as follows:

* Parse a given file with given project options, type check the file.
* Walk the abstract syntax tree generated by the previous step. At each node in the tree during the walk we generate a list of its children, apply each visitor to the current node which will give us a list of visitors to use for the child nodes, then walk the child nodes in order.

#####The Visitor Function

The key part to utilising this framework is writing visitor functions, these functions when passed to the ```parse``` function will be applied to every node representable by ```AstNode``` in the abstract syntax tree. 

The definition for a visitor function can be seen below:

    /// Defines a function that visits a node on the AST.
    type Visitor = CurrentNode -> VisitorResult
    and 
        /// Defines a function that a visitor will return when it wants to supply 
        /// specific visitors for the node its visiting's children
        GetVisitorForChild = int -> AstNode -> Visitor option
    and 
        /// The return value of a visitor that lets the it specify how the 
        /// children of a visited node should be visited.
        VisitorResult =
            | Continue
            | Stop
            | ContinueWithVisitor of Visitor
            | ContinueWithVisitorsForChildren of GetVisitorForChild

```VisitorResult``` gives the visitor function control on how the child nodes should be visited, and also allows for the visitor to keep state as the tree is walked purely.

* ```Stop``` will mean this visitor does not visit any of the children.
* ```Continue``` will continue to visit all child nodes with the current visitor.
* ```ContinueWithVisitor``` will visit the children with another visitor.
* ```ContinueWithVisitorsForChildren``` will visit some of the children with another visitor.

##Configuration

[Configuration.fs](https://github.com/duckmatt/FSharpLint/blob/master/src/FSharpLint.Framework/Configuration.fs) contains the code used to load configuration files into the configuration type ```Map<string,Analyser>```. A default configuration file exists inside this directory named [DefaultConfiguration.FSharpLint](https://github.com/duckmatt/FSharpLint/blob/master/src/FSharpLint.Framework/DefaultConfiguration.FSharpLint), this default file is embedded into the framework dll as a resource file, it should be loaded and then configuration files from elsewhere can be provided to override default rules.

The default configuration can be retrieved using ```loadDefaultConfiguration```, this is not a memoized function so try and call it just once.

Configuration files can be overrided using ```overrideConfiguration```.